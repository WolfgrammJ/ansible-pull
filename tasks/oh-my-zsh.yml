- name: make zsh default shell
  ansible.builtin.user:
    name: "{{ username }}"
    shell: "/usr/bin/zsh"

- name: Check if directory "~/.oh-my-zsh" exists
  become: "{{ username }}"
  stat:
    path: ~/.oh-my-zsh
  register: omz
  when: omz.stat.isdir is defined and omz.stat.isdir

- name: Install Oh-my-zsh
  become_user: "{{ username }}"
  command: sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
  when: omz.stat.exists == true
